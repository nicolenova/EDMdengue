---
title: "Convergent Cross-Mapping (Figure S8)"   
author:  | 
  | Nicole Nova, Ethan R. Deyle, Marta S. Shocket, Andrew J. MacDonald, Marissa L. Childs, Martin Rypdal, George Sugihara, and Erin A. Mordecai
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

## Convergent Cross-Mapping (Figure S8)

If necessary, we can clear the environment to start with a clean workspace.
```{r}
rm(list=ls())
```

First, we load the CCM results (from `Figure_3.Rmd`) with the data.
```{r}
load(file="../cache/CCM.RData")
```

Help functions.
```{r}
source("ccm_functions.R")
```

Here, we can load previous results.
```{r}
#load(file="../cache/Figure_S8.RData") 
```


### Figure S8

For Ebisuzaki distributions.
```{r}
getCCMresults("ebisuzaki", 1)
```

```{r}
plot.ccm("fig_S8")
```


### Kolmogorov-Smirnov test

Compare the distributions of the prediction skill generated by the null and that of the actual variables in CCM. This is to obtain a p-value to see whether the performance of the driver is distinguishable from the null. We compare distributions generated right after or close to convergence, so around the time series length of 100 weeks (Figure 3 and S8). We use the nonparametric K-S tests because the two distributions are not necessarily normal and they might have different variances.
```{r}
# For Figure S8 when using Ebisuzaki null
ks.results("prec")   # Significant
ks.results("mu")     # Significant
```

Here, we can save our progress.
```{r}
save.image(file="../cache/Figure_S8.RData") 
```